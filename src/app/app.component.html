<div class="container">
  <as-split direction="horizontal">  
    <as-split-area [size]="30"  style="position: relative; overflow: hidden;">
      <ifc-viewer [settings]="modelViewerSettings"></ifc-viewer>
    </as-split-area>

    <as-split-area [size]="70" style="padding: 10px; overflow-y: scroll; display: flex; flex-direction: column; gap: 10px">
      <input #ifcUpload type="file" (change)="onModelUpload($event)" style="display:none" accept=".ifc">
      <mat-toolbar class="flexSpaceBetween" >
        <button class="btn" mat-raised-button (click)="ifcUpload.click()">
          Upload model <mat-icon>cloud_upload</mat-icon>
        </button>

        <button class="btn" mat-raised-button [disabled]="!fileUploaded" (click)="extractData()">
          Extract Data <mat-icon>arrow_right_alt</mat-icon>
        </button>

        <button class="btn" mat-raised-button [disabled]="!dataExtracted" (click)="exportExcel()">
          Export to Excel <mat-icon>cloud_download</mat-icon>
        </button>
      
        <button class="btn" mat-raised-button [disabled]="!fileUploaded"  (click)="getSpaceTabel()">
          Get Standard Room Tabel <mat-icon>home</mat-icon>
        </button>
    </mat-toolbar>

      <div *ngIf="fileUploaded"> Select which types you want to make the data extraction for:
        <br>
        <p> Make individual selection / Select All:
          <input type="checkbox" [(ngModel)]="masterCheck" (click)="onSelectAll()" >
        </p>
        <ul class="IfcTypeList">
          <li *ngFor="let item of allTypes"> 
            <input type="checkbox" [(ngModel)]="item.checked">{{item.type}}
          </li>
        </ul>
      </div>
      
      <mat-progress-bar *ngIf="modelLoading" mode="indeterminate" class="mat-progress-bar-buffer"></mat-progress-bar>

      <div *ngIf="displaySpaceTabel" > Standard room tabel
        <tr style="width: 100%;"> 
          <th style="width: 100%;">Space</th>
          <th style="width: 100%;">Name</th>
          <th style="width: 100%;">Label</th>
          <th style="width: 100%;">Level</th>
          <th style="width: 100%;">Area</th>
        </tr>
        <table *ngFor="let i of allSpaceData" style="width: 100%;">
            <td style="width: 100%;"> {{i.space}}</td>
            <td style="width: 100%;">{{i.spaceName}}</td>
            <td style="width: 100%;">{{i.spaceLabel}}</td>
            <td style="width: 100%;">{{i.spaceLevel}}</td>
            <td style="width: 100%;">{{i.spaceArea}}</td>
        </table>
      </div>

      <div *ngIf="dataExtracted" id="excel-table"> Results from data extraction, which can be exported to Excel
      <table *ngFor="let i of allElements" style="width: 100%;">
        <tr> 
          <th>IfcType</th>
          <th>ID</th>
          <th>Property Set</th>
          <th>Property</th>
          <th>Value</th>
        </tr>
        <tr *ngFor="let item of i">
          <td>{{item.TypeName}}</td>
          <td>{{item.instGUID}}</td>
          <td>{{item.pSet}}</td>
          <td>{{item.property}}</td>
          <td>{{item.value}}</td>          
        </tr>

      </table>
    </div>
  
    </as-split-area>
  </as-split>
</div>